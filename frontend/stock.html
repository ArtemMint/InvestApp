<!doctype html>
<html lang="uk">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>–ì—Ä–∞—Ñ—ñ–∫ –ê–∫—Ü—ñ–π</title>
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
      :root{
        --bg1: #f6fbff;
        --bg2: #f3fff9;
        --card: #ffffff;
        --muted: #6b7280;
        --accent: #6ee7b7;
        --accent-2: #93c5fd;
        --shadow: 0 6px 18px rgba(16,24,40,0.08);
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      }

      html,body{
        height:100%;
        margin:0;
        background:linear-gradient(135deg,var(--bg1) 0%, var(--bg2) 100%);
        color:#0f172a;
      }

      .container{
        max-width:1400px;
        margin:32px auto;
        padding:24px;
      }

      header{
        display:flex;
        align-items:center;
        justify-content:space-between;
        margin-bottom:20px;
        flex-wrap: wrap;
        gap: 16px;
      }

      .brand{
        display:flex;
        align-items:center;
        gap:12px;
      }

      .logo{
        width:48px;
        height:48px;
        border-radius:12px;
        background:linear-gradient(135deg,var(--accent-2),var(--accent));
        box-shadow:var(--shadow);
        display:flex;
        align-items:center;
        justify-content:center;
        color:white;
        font-weight:700;
      }

      h1{
        font-size:1.4rem;
        margin:0;
      }

      .controls{
        display:flex;
        gap:12px;
        align-items:center;
        flex-wrap: wrap;
      }

      .input-group{
        display:flex;
        gap:8px;
        align-items:center;
      }

      .input-group label{
        font-size:0.9rem;
        color:var(--muted);
        font-weight:600;
      }

      .input-group input, .input-group select{
        padding:8px 12px;
        border-radius:8px;
        border:1px solid rgba(15,23,42,0.1);
        background:white;
        font-size:0.9rem;
      }

      .btn{
        background:linear-gradient(180deg,var(--accent),var(--accent-2));
        border:none;
        padding:10px 16px;
        border-radius:10px;
        color:#04202b;
        font-weight:600;
        cursor:pointer;
        box-shadow:0 8px 20px rgba(99,102,241,0.08);
        transition: transform 0.2s;
      }

      .btn:hover{
        transform: translateY(-2px);
      }

      .btn:active{
        transform: translateY(0);
      }

      .chart-container{
        background:var(--card);
        border-radius:12px;
        padding:24px;
        box-shadow:var(--shadow);
        margin-bottom:20px;
      }

      .chart-header{
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:16px;
      }

      .chart-title{
        font-size:1.2rem;
        font-weight:700;
        margin:0;
      }

      .ticker-symbol{
        color:var(--accent-2);
        font-size:1.4rem;
        font-weight:800;
      }

      .chart-info{
        font-size:0.85rem;
        color:var(--muted);
      }

      #chartCanvas{
        height:600px;
        width:100%;
      }

      .loading{
        display:none;
        text-align:center;
        padding:40px;
        color:var(--muted);
        font-size:1.1rem;
      }

      .loading.show{
        display:block;
      }

      .error{
        display:none;
        background:#fee;
        color:#c00;
        padding:16px;
        border-radius:8px;
        margin-bottom:16px;
        border-left:4px solid #c00;
      }

      .error.show{
        display:block;
      }

      .stats-grid{
        display:grid;
        grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
        gap:16px;
        margin-bottom:20px;
      }

      .stat-card{
        background:var(--card);
        border-radius:10px;
        padding:16px;
        box-shadow:var(--shadow);
      }

      .stat-label{
        font-size:0.85rem;
        color:var(--muted);
        margin-bottom:4px;
      }

      .stat-value{
        font-size:1.3rem;
        font-weight:700;
      }

      .stat-value.positive{
        color:#10b981;
      }

      .stat-value.negative{
        color:#ef4444;
      }

      .analytics-grid{
        display:grid;
        grid-template-columns:repeat(auto-fit, minmax(400px, 1fr));
        gap:20px;
        margin-bottom:20px;
      }

      .recommendations-container,
      .target-price-container,
      .earnings-container{
        background:var(--card);
        border-radius:12px;
        padding:24px;
        box-shadow:var(--shadow);
      }

      .recommendations-header,
      .target-price-header,
      .earnings-header{
        font-size:1.1rem;
        font-weight:700;
        margin-bottom:16px;
        color:#0f172a;
      }

      #recommendationsChart,
      #targetPriceChart,
      #earningsChart{
        max-width:500px;
        margin:0 auto;
      }

      /* Navigation */
      nav{
        background: var(--card);
        border-radius: 12px;
        padding: 16px 24px;
        margin-bottom: 24px;
        box-shadow: var(--shadow);
        display: flex;
        gap: 12px;
        align-items: center;
        flex-wrap: wrap;
      }

      .nav-brand{
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 700;
        font-size: 1.1rem;
        margin-right: auto;
      }

      .nav-logo{
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background: linear-gradient(135deg,var(--accent-2),var(--accent));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        text-decoration: none;
      }

      .nav-link{
        padding: 10px 20px;
        border-radius: 8px;
        text-decoration: none;
        color: #0f172a;
        font-weight: 600;
        transition: all 0.2s;
        border: 2px solid transparent;
      }

      .nav-link:hover{
        background: rgba(110, 231, 183, 0.1);
        border-color: var(--accent);
      }

      .nav-link.active{
        background: linear-gradient(180deg,var(--accent),var(--accent-2));
        color: #04202b;
      }

      @media (max-width:768px){
        .controls{
          width:100%;
        }
        .input-group{
          flex:1;
        }
        #chartCanvas{
          height:400px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Navigation -->
      <nav>
        <div class="nav-brand">
          <a class="nav-logo" href="index.html">üí∞</a>
          InvestApp
        </div>
        <a href="stock.html" class="nav-link active">üìà –ê–∫—Ü—ñ—ó</a>
        <a href="investment.html" class="nav-link">üíπ –Ü–Ω–≤–µ—Å—Ç–∏—Ü—ñ–π–Ω–∏–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</a>
      </nav>

      <header>
        <div class="brand">
          <div class="logo">üìà</div>
          <div>
            <h1>–ì—Ä–∞—Ñ—ñ–∫ –ê–∫—Ü—ñ–π</h1>
          </div>
        </div>
        <div class="controls">
          <div class="input-group">
            <label for="ticker">–¢—ñ–∫–µ—Ä:</label>
            <input type="text" id="ticker" value="GOOG" placeholder="" />
          </div>
          <div class="input-group">
            <label for="period">–ü–µ—Ä—ñ–æ–¥:</label>
            <select id="period">
              <option value="1d">1 –¥–µ–Ω—å</option>
              <option value="5d">5 –¥–Ω—ñ–≤</option>
              <option value="1mo" selected>1 –º—ñ—Å—è—Ü—å</option>
              <option value="3mo">3 –º—ñ—Å—è—Ü—ñ</option>
              <option value="6mo">6 –º—ñ—Å—è—Ü—ñ–≤</option>
              <option value="1y">1 —Ä—ñ–∫</option>
              <option value="2y">2 —Ä–æ–∫–∏</option>
              <option value="5y">5 —Ä–æ–∫—ñ–≤</option>
            </select>
          </div>
          <div class="input-group">
            <label for="interval">–Ü–Ω—Ç–µ—Ä–≤–∞–ª:</label>
            <select id="interval">
              <option value="1m">1 —Ö–≤</option>
              <option value="5m">5 —Ö–≤</option>
              <option value="15m">15 —Ö–≤</option>
              <option value="1h" selected>1 –≥–æ–¥</option>
              <option value="1d">1 –¥–µ–Ω—å</option>
              <option value="1wk">1 —Ç–∏–∂–¥–µ–Ω—å</option>
            </select>
          </div>
          <button class="btn" id="loadBtn">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
        </div>
      </header>

      <div class="error" id="errorMsg"></div>

      <div class="stats-grid" id="statsGrid" style="display:none;">
        <div class="stat-card">
          <div class="stat-label">–ü–æ—Ç–æ—á–Ω–∞ —Ü—ñ–Ω–∞</div>
          <div class="stat-value" id="currentPrice">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">–ú–∞–∫—Å–∏–º—É–º</div>
          <div class="stat-value" id="highPrice">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">–ú—ñ–Ω—ñ–º—É–º</div>
          <div class="stat-value" id="lowPrice">-</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">–û–±'—î–º</div>
          <div class="stat-value" id="totalVolume">-</div>
        </div>
      </div>

      <div class="chart-container">
        <div class="chart-header">
          <h2 class="chart-title">
            <span class="ticker-symbol" id="tickerDisplay"></span>
          </h2>
          <div class="chart-info" id="chartInfo">–ü–µ—Ä—ñ–æ–¥: 1mo | –Ü–Ω—Ç–µ—Ä–≤–∞–ª: 1h</div>
        </div>
        <div class="loading" id="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...</div>
        <div id="chartCanvas"></div>
      </div>

      <div class="analytics-grid" id="analyticsGrid" style="display:none;">
        <div class="recommendations-container">
          <div class="recommendations-header">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –∞–Ω–∞–ª—ñ—Ç–∏–∫—ñ–≤</div>
          <div id="recommendationsChart"></div>
        </div>

        <div class="target-price-container">
          <div class="target-price-header">–¶—ñ–ª—å–æ–≤–∞ —Ü—ñ–Ω–∞</div>
          <div id="targetPriceChart"></div>
        </div>

        <div class="earnings-container">
          <div class="earnings-header">–ü—Ä–∏–±—É—Ç–∫–∏ (EPS)</div>
          <div id="earningsChart"></div>
        </div>
      </div>
    </div>

    <script>
      const apiBase = '/api/v1/stock';

      let chart = null;
      let candlestickSeries = null;
      let volumeSeries = null;
      let recommendationsChart = null;
      let targetPriceChart = null;
      let earningsChart = null;

      // Initialize chart
      function initChart() {
        const chartElement = document.getElementById('chartCanvas');

        if (chart) {
          chart.remove();
        }

        chart = LightweightCharts.createChart(chartElement, {
          width: chartElement.clientWidth,
          height: 600,
          layout: {
            background: { color: '#ffffff' },
            textColor: '#333',
          },
          grid: {
            vertLines: { color: '#f0f0f0' },
            horzLines: { color: '#f0f0f0' },
          },
          crosshair: {
            mode: LightweightCharts.CrosshairMode.Normal,
          },
          rightPriceScale: {
            borderColor: '#d1d4dc',
          },
          timeScale: {
            borderColor: '#d1d4dc',
            timeVisible: true,
            secondsVisible: false,
          },
        });

        candlestickSeries = chart.addCandlestickSeries({
          upColor: '#26a69a',
          downColor: '#ef5350',
          borderVisible: false,
          wickUpColor: '#26a69a',
          wickDownColor: '#ef5350',
          priceScaleId: 'right',
        });

        volumeSeries = chart.addHistogramSeries({
          color: '#93c5fd',
          priceFormat: {
            type: 'volume',
          },
          priceScaleId: 'volume',
        });

        // Configure price scale for candlesticks (top 75% of chart)
        chart.priceScale('right').applyOptions({
          scaleMargins: {
            top: 0.1,
            bottom: 0.3,
          },
        });

        // Configure price scale for volume (bottom 20% of chart)
        chart.priceScale('volume').applyOptions({
          scaleMargins: {
            top: 0.8,
            bottom: 0,
          },
        });

        // Handle window resize
        window.addEventListener('resize', () => {
          chart.applyOptions({ width: chartElement.clientWidth });
        });
      }

      async function loadStockData() {
        const ticker = document.getElementById('ticker').value.trim().toUpperCase();
        const period = document.getElementById('period').value;
        const interval = document.getElementById('interval').value;

        if (!ticker) {
          showError('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —Ç—ñ–∫–µ—Ä –∞–∫—Ü—ñ—ó');
          return;
        }

        hideError();
        showLoading(true);
        document.getElementById('statsGrid').style.display = 'none';

        try {
          const response = await fetch(`${apiBase}/?stock_ticker=${ticker}&period=${period}&interval=${interval}`);
          const data = await response.json();

          if (data.error) {
            showError(data.error);
            showLoading(false);
            return;
          }

          if (!data.data || data.data.length === 0) {
            showError('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è');
            showLoading(false);
            return;
          }

          // Update header info
          document.getElementById('tickerDisplay').textContent = data.ticker;
          document.getElementById('chartInfo').textContent = `–ü–µ—Ä—ñ–æ–¥: ${data.period} | –Ü–Ω—Ç–µ—Ä–≤–∞–ª: ${data.interval}`;

          // Process and display data
          displayChart(data.data);
          updateStats(data.data);

          // Load all analytics
          loadAllAnalytics(ticker);

          showLoading(false);
          document.getElementById('statsGrid').style.display = 'grid';
        } catch (error) {
          showError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö: ' + error.message);
          showLoading(false);
        }
      }

      function displayChart(stockData) {
        if (!chart) {
          initChart();
        }

        // Convert data to chart format
        const candleData = stockData.map(item => ({
          time: new Date(item.time).getTime() / 1000,
          open: item.open,
          high: item.high,
          low: item.low,
          close: item.close,
        }));

        const volumeData = stockData.map(item => ({
          time: new Date(item.time).getTime() / 1000,
          value: item.volume,
          color: item.close >= item.open ? 'rgba(38, 166, 154, 0.5)' : 'rgba(239, 83, 80, 0.5)',
        }));

        candlestickSeries.setData(candleData);
        volumeSeries.setData(volumeData);

        // Fit content
        chart.timeScale().fitContent();
      }

      function updateStats(stockData) {
        if (stockData.length === 0) return;

        const latestData = stockData[stockData.length - 1];
        const firstData = stockData[0];

        const currentPrice = latestData.close;
        const priceChange = currentPrice - firstData.close;
        const priceChangePercent = ((priceChange / firstData.close) * 100).toFixed(2);

        const highPrice = Math.max(...stockData.map(d => d.high));
        const lowPrice = Math.min(...stockData.map(d => d.low));
        const totalVolume = stockData.reduce((sum, d) => sum + d.volume, 0);

        // Update stats
        document.getElementById('currentPrice').textContent = `${currentPrice.toFixed(2)}`;

        const changeElement = document.getElementById('currentPrice');
        const changeSign = priceChange >= 0 ? '+' : '';
        changeElement.textContent = `${currentPrice.toFixed(2)}  ${priceChange.toFixed(2)} (${changeSign}${priceChangePercent}%)`;
        changeElement.className = `stat-value ${priceChange >= 0 ? 'positive' : 'negative'}`;

        document.getElementById('highPrice').textContent = `${highPrice.toFixed(2)}`;
        document.getElementById('lowPrice').textContent = `${lowPrice.toFixed(2)}`;
        document.getElementById('totalVolume').textContent = formatVolume(totalVolume);
      }

      function formatVolume(volume) {
        if (volume >= 1e9) return (volume / 1e9).toFixed(2) + 'B';
        if (volume >= 1e6) return (volume / 1e6).toFixed(2) + 'M';
        if (volume >= 1e3) return (volume / 1e3).toFixed(2) + 'K';
        return volume.toString();
      }

      function showLoading(show) {
        const loading = document.getElementById('loading');
        const chartCanvas = document.getElementById('chartCanvas');

        if (show) {
          loading.classList.add('show');
          chartCanvas.style.display = 'none';
        } else {
          loading.classList.remove('show');
          chartCanvas.style.display = 'block';
        }
      }

      function showError(message) {
        const errorElement = document.getElementById('errorMsg');
        errorElement.textContent = message;
        errorElement.classList.add('show');
      }

      function hideError() {
        document.getElementById('errorMsg').classList.remove('show');
      }

      async function loadAllAnalytics(ticker) {
        const analyticsGrid = document.getElementById('analyticsGrid');
        analyticsGrid.style.display = 'none';

        try {
          // Load all three endpoints in parallel
          const [recommendations, targetPrice, earnings] = await Promise.all([
            fetch(`${apiBase}/recommendations?stock_ticker=${ticker}`).then(r => r.json()).catch(() => null),
            fetch(`${apiBase}/price_target?stock_ticker=${ticker}`).then(r => r.json()).catch(() => null),
            fetch(`${apiBase}/earnings_history?stock_ticker=${ticker}`).then(r => r.json()).catch(() => null)
          ]);

          let hasData = false;

          if (recommendations && !recommendations.error && recommendations.strongBuy !== undefined) {
            displayRecommendations(recommendations);
            hasData = true;
          }

          if (targetPrice && !targetPrice.error && targetPrice.mean) {
            displayTargetPrice(targetPrice);
            hasData = true;
          }

          if (earnings && !earnings.error && earnings.epsActual) {
            displayEarnings(earnings);
            hasData = true;
          }

          if (hasData) {
            analyticsGrid.style.display = 'grid';
          }
        } catch (error) {
          console.error('Error loading analytics:', error);
        }
      }

      async function loadRecommendations(ticker) {
        try {
          const response = await fetch(`${apiBase}/recommendations?stock_ticker=${ticker}`);
          const data = await response.json();

          if (data.error || !data.strongBuy) {
            document.getElementById('recommendationsContainer').style.display = 'none';
            return;
          }

          displayRecommendations(data);
          document.getElementById('recommendationsContainer').style.display = 'block';
        } catch (error) {
          console.error('Error loading recommendations:', error);
          document.getElementById('recommendationsContainer').style.display = 'none';
        }
      }

      function displayRecommendations(data) {
        const categories = ['–°–∏–ª—å–Ω–∞ –∫—É–ø—ñ–≤–ª—è', '–ö—É–ø—ñ–≤–ª—è', '–£—Ç—Ä–∏–º—É–≤–∞—Ç–∏', '–ü—Ä–æ–¥–∞–∂', '–°–∏–ª—å–Ω–∏–π –ø—Ä–æ–¥–∞–∂'];
        const values = [
          data.strongBuy || 0,
          data.buy || 0,
          data.hold || 0,
          data.sell || 0,
          data.strongSell || 0
        ];

        // Filter out zero values
        const filteredData = categories.map((cat, idx) => ({
          category: cat,
          value: values[idx]
        })).filter(item => item.value > 0);

        if (recommendationsChart) {
          recommendationsChart.destroy();
        }

        const options = {
          series: filteredData.map(item => item.value),
          chart: {
            type: 'donut',
            height: 350,
          },
          labels: filteredData.map(item => item.category),
          colors: ['#10b981', '#6ee7b7', '#93c5fd', '#fbbf24', '#ef4444'],
          legend: {
            position: 'bottom',
            fontSize: '14px',
          },
          plotOptions: {
            pie: {
              donut: {
                size: '65%',
                labels: {
                  show: true,
                  total: {
                    show: true,
                    label: '–í—Å—å–æ–≥–æ',
                    fontSize: '16px',
                    fontWeight: 600,
                  }
                }
              }
            }
          },
          dataLabels: {
            enabled: true,
            formatter: function(val, opts) {
              return opts.w.config.series[opts.seriesIndex];
            },
          },
          tooltip: {
            y: {
              formatter: function(value) {
                return value + ' –∞–Ω–∞–ª—ñ—Ç–∏–∫' + (value > 1 ? '—ñ–≤' : '');
              }
            }
          },
          responsive: [{
            breakpoint: 480,
            options: {
              chart: {
                height: 300
              },
              legend: {
                position: 'bottom'
              }
            }
          }]
        };

        recommendationsChart = new ApexCharts(document.querySelector("#recommendationsChart"), options);
        recommendationsChart.render();
      }

      function displayTargetPrice(data) {
        if (targetPriceChart) {
          targetPriceChart.destroy();
        }

        const options = {
          series: [{
            name: '–¶—ñ–Ω–∞',
            data: [
              { x: '–ü–æ—Ç–æ—á–Ω–∞', y: data.current || 0 },
              { x: '–°–µ—Ä–µ–¥–Ω—è', y: data.mean || 0 }
            ]
          }],
          chart: {
            type: 'bar',
            height: 350,
            toolbar: { show: false }
          },
          plotOptions: {
            bar: {
              horizontal: false,
              columnWidth: '55%',
              distributed: true,
              dataLabels: {
                position: 'top'
              }
            }
          },
          colors: ['#93c5fd', '#10b981'],
          dataLabels: {
            enabled: true,
            formatter: function(val) {
              return '$' + val.toFixed(2);
            },
            offsetY: -20,
            style: {
              fontSize: '12px',
              colors: ["#304758"]
            }
          },
          xaxis: {
            categories: ['–ü–æ—Ç–æ—á–Ω–∞', '–¶—ñ–ª—å–æ–≤–∞'],
          },
          yaxis: {
            title: {
              text: '–¶—ñ–Ω–∞ ($)'
            },
            labels: {
              formatter: function(val) {
                return '$' + val.toFixed(0);
              }
            }
          },
          legend: { show: false },
          tooltip: {
            y: {
              formatter: function(val) {
                return '$' + val.toFixed(2);
              }
            }
          }
        };

        targetPriceChart = new ApexCharts(document.querySelector("#targetPriceChart"), options);
        targetPriceChart.render();
      }

      function displayEarnings(data) {
        if (earningsChart) {
          earningsChart.destroy();
        }

        // Convert timestamps to dates
        const dates = Object.keys(data.epsActual).map(ts => {
          const date = new Date(ts);
          return date.toLocaleDateString('uk-UA', { year: 'numeric', month: 'short' });
        });

        const actual = Object.values(data.epsActual);
        const estimate = Object.values(data.epsEstimate);

        const options = {
          series: [
            {
              name: '–§–∞–∫—Ç–∏—á–Ω–∏–π EPS',
              data: actual
            },
            {
              name: '–ü—Ä–æ–≥–Ω–æ–∑ EPS',
              data: estimate
            }
          ],
          chart: {
            type: 'bar',
            height: 350,
            toolbar: { show: false }
          },
          plotOptions: {
            bar: {
              horizontal: false,
              columnWidth: '55%',
              dataLabels: {
                position: 'top'
              }
            }
          },
          colors: ['#10b981', '#93c5fd'],
          dataLabels: {
            enabled: true,
            formatter: function(val) {
              return val.toFixed(2);
            },
            offsetY: -20,
            style: {
              fontSize: '11px',
              colors: ["#304758"]
            }
          },
          stroke: {
            show: true,
            width: 2,
            colors: ['transparent']
          },
          xaxis: {
            categories: dates,
          },
          yaxis: {
            title: {
              text: 'EPS ($)'
            },
            labels: {
              formatter: function(val) {
                return val.toFixed(2);
              }
            }
          },
          fill: {
            opacity: 1
          },
          tooltip: {
            y: {
              formatter: function(val) {
                return '$' + val.toFixed(2);
              }
            }
          },
          legend: {
            position: 'top',
            horizontalAlign: 'center'
          }
        };

        earningsChart = new ApexCharts(document.querySelector("#earningsChart"), options);
        earningsChart.render();
      }

      // Event listeners
      document.getElementById('loadBtn').addEventListener('click', loadStockData);

      // Allow Enter key to load data
      document.getElementById('ticker').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') loadStockData();
      });

      // Load initial data
      window.addEventListener('load', () => {
        initChart();
        loadStockData();
      });
    </script>
  </body>
</html>

